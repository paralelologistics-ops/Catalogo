function doGet(e) {
  try {
    var sheet = SpreadsheetApp.openById('1V5QWA5F_BCVrYYMiDjnFKKlJUgUHMEpUJt21rB7_A5A').getSheetByName('catalogo trickle');
    var data = sheet.getDataRange().getValues();
    var headers = data[0];
    var jsonData = [];
    
    for (var i = 1; i < data.length; i++) {
      var row = data[i];
      var record = {};
      for (var j = 0; j < headers.length; j++) {
        record[headers[j]] = row[j];
      }
      jsonData.push(record);
    }
    
    // VersiÃ³n simplificada sin setHeaders()
    var output = ContentService.createTextOutput(JSON.stringify(jsonData));
    output.setMimeType(ContentService.MimeType.JSON);
    return output;
  } catch (error) {
    var output = ContentService.createTextOutput(JSON.stringify({error: error.message}));
    output.setMimeType(ContentService.MimeType.JSON);
    return output;
  }
}
